<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="dark" />
  <title>TruthVerify — Verification Record</title>
  <style>
    :root{
      --bg:#07080b; --border:rgba(255,255,255,.10);
      --text:rgba(255,255,255,.92); --muted:rgba(255,255,255,.65);
      --good:#58d08a; --warn:#f7c35f;
    }
    body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui}
    .wrap{max-width:820px;margin:0 auto;padding:22px 16px 70px}
    .card{margin-top:14px;border:1px solid var(--border);border-radius:18px;background:rgba(255,255,255,.04);padding:16px}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono",monospace}
    .pill{display:inline-flex;gap:8px;align-items:center;padding:7px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.03);font-size:12px;color:var(--muted)}
    .status.ok{color:var(--good)}
    .status.pending{color:var(--warn)}
    .kv{display:grid;grid-template-columns:160px 1fr;gap:8px 10px;margin-top:12px}
    @media(max-width:700px){.kv{grid-template-columns:1fr}}
    .kv div{padding:10px;border:1px solid rgba(255,255,255,.08);border-radius:14px;background:rgba(255,255,255,.02);word-break:break-word}
  .btnRow{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
.btn{
  appearance:none;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(255,255,255,.06);
  color:var(--text);
  padding:10px 12px;
  border-radius:14px;
  font-size:13px;
  cursor:pointer;
}
.btn:active{transform:scale(.99)}
.badgeWrap{display:flex;gap:14px;align-items:flex-start;flex-wrap:wrap}
.badgePreview{
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.25);
  border-radius:16px;
  padding:12px;
  width:min(360px,100%);
}
.small{
  color:var(--muted);
  font-size:12px;
  margin-top:8px;
  line-height:1.35;

  </style>
</head>
<body>
<div class="wrap">
  <div style="display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap;">
    <div>
      <h2 style="margin:0 0 6px;">Verification record</h2>
      <div class="pill">Badge ID: <span class="mono" id="badgeId"></span></div>
    </div>
    <div style="display:flex;gap:10px;">
      <a class="pill" href="./">/v Dashboard</a>
      <a class="pill" href="../">Home</a>
    </div>
  </div>

  <div class="card" id="state">Loading…</div>
  <div class="card" id="details" style="display:none;"></div>
</div>

<script>
  const id = new URLSearchParams(location.search).get("id");
  document.getElementById("badgeId").textContent = id || "(missing)";

  async function load(){
    try{
      const res = await fetch("./data.json", {cache:"no-store"});
      const data = await res.json();
      const rec = (data.records || data).find(r => (r.badge || r.badgeId || r.id) === id);

      const state = document.getElementById("state");
      const details = document.getElementById("details");

      if(!rec){
        state.innerHTML = "<b>Not found.</b><div style='color:rgba(255,255,255,.65);margin-top:6px;'>Badge ID not in public dataset.</div>";
        return;
      }

      const status = (rec.status || "pending").toLowerCase();
      state.innerHTML = `<b>Status:</b> <span class="status ${status}">${rec.status}</span>`;

      const rows = [
  ["Creator", rec.creator_name || rec.creator || rec.creatorName || "—"],
  ["Handle", rec.handle || "—"],
  ["Platform", rec.platform || "—"],
  ["Issued", rec.issued_at || "—"],
  ["Expires", rec.expires_at || "—"],
  ["Notes", rec.notes || "—"]
];


      details.style.display = "block";
      details.innerHTML = `<div class="kv">${
        rows.map(([k,v])=>`<div><b>${k}</b></div><div class="mono">${v ?? "—"}</div>`).join("")
      }</div>`;
      try { setupDownloads?.(rec, id); } catch (err) { console.warn("downloads error", err); }
    }catch(e){
      document.getElementById("state").textContent = "Failed to load verification record.";
    }
  }
  load();
</script>
</body>
</html>